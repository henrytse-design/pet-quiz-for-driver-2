<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯›å­©ç•Œå˜…äº”æ˜Ÿç´šå¸æ©Ÿæ¸¬é©—</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .container {
            max-width: 600px;
        }
        .question-option {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .question-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .loading-spinner {
            border-top-color: #3B82F6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .pet-emoji {
            font-size: 3rem;
            transition: transform 0.3s;
        }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

    <!-- ä¸»å®¹å™¨ -->
    <div id="game-container" class="bg-white rounded-xl shadow-2xl p-6 md:p-10 w-full container">

        <!-- å¸æ©Ÿè³‡æ–™è¼¸å…¥é é¢ -->
        <div id="info-page" class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
                ã€æ¸¬è©¦ï¼šä½ ä¿‚æ¯›å­©ç•Œå˜…äº”æ˜Ÿç´šå¸æ©Ÿå—ï¼Ÿã€‘
            </h1>
            <p class="text-gray-600 mb-6 text-sm md:text-base">
                æ¸¬é©—æ»¿åˆ†å˜…æ¯›å­©ç•Œäº”æ˜Ÿç´šå¸æ©Ÿï¼Œå³å¯ç²å¾—20 GOåˆ†ï¼
            </p>
            <p class="text-gray-600 mb-8 text-sm md:text-base">
                è«‹è¼¸å…¥ä½ çš„å¸æ©ŸIDåŒé›»è©±è™Ÿç¢¼ï¼Œç„¶å¾Œé–‹å§‹æ¸¬è©¦ï¼ğŸ˜Š
            </p>

            <div class="space-y-4 mb-6">
                <input type="text" id="driver-id" placeholder="è¼¸å…¥ä½ çš„å¸æ©ŸID" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="tel" id="phone-number" placeholder="è¼¸å…¥ä½ çš„é›»è©±è™Ÿç¢¼" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            
            <div id="info-error" class="text-red-500 mb-4 hidden"></div>

            <button id="start-btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg shadow-md hover:bg-blue-700 transition duration-300">
                é–‹å§‹æ¸¬è©¦
            </button>
        </div>

        <!-- æ¸¬é©—é é¢ -->
        <div id="quiz-page" class="hidden text-center">
            <!-- å¯µç‰©è¡¨æƒ…å€ -->
            <div class="flex justify-center items-center space-x-6 mb-8">
                <span id="dog-emoji" class="pet-emoji">ğŸ¶</span>
                <span id="cat-emoji" class="pet-emoji">ğŸ±</span>
            </div>
            
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-semibold text-gray-700 mb-2">
                    <span id="question-number"></span>
                </h2>
                <p id="question-text" class="text-lg md:text-xl text-gray-800 font-medium"></p>
            </div>
            
            <div id="options-container" class="space-y-3">
                <!-- é¸é …æœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
            </div>

            <!-- ç­”æ¡ˆå›é¥‹è¨Šæ¯ -->
            <div id="feedback-message" class="mt-6 text-lg font-bold"></div>
        </div>

        <!-- çµæœé é¢ -->
        <div id="result-page" class="hidden text-center">
            <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded-lg mb-6" role="alert">
                <p class="font-bold text-lg md:text-xl">æ¸¬è©¦å®Œæˆï¼</p>
                <p id="final-score-text" class="mt-2 text-base md:text-lg"></p>
            </div>
            <div id="loading-message" class="hidden">
                <div class="flex items-center justify-center space-x-2">
                    <div class="loading-spinner h-6 w-6 border-4 rounded-full border-gray-200"></div>
                    <span class="text-gray-600 font-medium">æ­£åœ¨æäº¤çµæœ...</span>
                </div>
            </div>
            <div id="submit-success" class="hidden">
                <div class="flex items-center justify-center space-x-2 text-green-600 font-bold">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>çµæœå·²æˆåŠŸæäº¤ï¼</span>
                </div>
            </div>
            <div id="submit-error" class="hidden">
                <div class="flex items-center justify-center space-x-2 text-red-600 font-bold">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>æäº¤å¤±æ•—ï¼Œè«‹é‡è©¦ã€‚</span>
                </div>
            </div>
        </div>

    </div>

    <script>
        const infoPage = document.getElementById('info-page');
        const quizPage = document.getElementById('quiz-page');
        const resultPage = document.getElementById('result-page');
        const startBtn = document.getElementById('start-btn');
        const driverIdInput = document.getElementById('driver-id');
        const phoneNumberInput = document.getElementById('phone-number');
        const infoError = document.getElementById('info-error');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const finalScoreTextEl = document.getElementById('final-score-text');
        const loadingMessageEl = document.getElementById('loading-message');
        const submitSuccessEl = document.getElementById('submit-success');
        const submitErrorEl = document.getElementById('submit-error');
        const dogEmojiEl = document.getElementById('dog-emoji');
        const catEmojiEl = document.getElementById('cat-emoji');
        const feedbackMessageEl = document.getElementById('feedback-message');

        const GOOGLE_SHEET_APP_URL = "https://script.google.com/macros/s/AKfycbxx2zNR8ag5iMQGGF4WYZwWwaGOQj45LZgdCjc29IXNwt7Kr3ed4fnefieinLHQknaa/exec";

        let currentQuestionIndex = 0;
        let score = 0;
        let driverId = '';
        let phoneNumber = '';

        const quizData = [
            {
                question: 'æ¥åˆ°å¯µç‰©è¨‚å–®å¾Œï¼Œæ‡‰è©²é»æ¨£èˆ‡å®¢äººæºé€šï¼Ÿ',
                options: ['A. å””ä½¿ç‰¹åˆ¥è¯çµ¡ï¼Œç›´æ¥ä¸Šé–€æ¥è¼‰', 'B. æ‰“é›»è©±äº†è§£å¯µç‰©æ“ºä½åŠç‰¹åˆ¥äº‹é …', 'C. ç­‰å®¢äººä¸»å‹•è¯çµ¡'],
                answer: 'B'
            },
            {
                question: 'æ¯æ¬¡æ¥è¼‰å¯µç‰©å¾Œï¼Œæ‡‰è©²åšå•²å’©æ¸…æ½”å·¥ä½œï¼Ÿ',
                options: ['A. å””éœ€è¦æ¸…æ½”', 'B. æ‰“æƒåº§ä½ï¼Œç¢ºä¿è»Šå»‚ç„¡ç•°å‘³', 'C. åªéœ€æ‰“æƒè¦‹åˆ°æ±¡æ¼¬å˜…éƒ¨åˆ†'],
                answer: 'B'
            },
            {
                question: 'æ¥è¼‰å¤§éš»é‡‘æ¯›åŒç´°ç´°ç²’èŒ¶æ¯è²´å©¦ï¼Œæ‡‰è©²æœ‰å””åŒå˜…æœå‹™æ…‹åº¦å—ï¼Ÿ',
                options: ['A. ç„¡éœ€è¦ï¼Œæ‰€æœ‰æ¯›å­©éƒ½æ‡‰ä¸€è¦–åŒä»', 'B. å¤§ç‹—ç‰¹åˆ¥æ³¨æ„ï¼Œå°ç‹—å¯ä»¥éš¨æ„', 'C. ç‡å¿ƒæƒ…'],
                answer: 'A'
            },
            {
                question: 'é»æ¨£ä»¤å¯µç‰©å–ºè»Šä¸Šæ„Ÿåˆ°è¼•é¬†è‡ªåœ¨ï¼Ÿ',
                options: ['A. å¤§è²åŒä½¢å“‹è¬›è©±ï¼Œå¢åŠ ç†Ÿæ‚‰æ„Ÿ', 'B. æ”¾è¼•è²é‡ï¼Œä¿æŒè¦ªåˆ‡ç¬‘å®¹', 'C. å””ç†ä½¢å“‹ï¼Œå°ˆæ³¨é§•é§›'],
                answer: 'B'
            },
            {
                question: 'å¦‚æœå®¢äººéœ€è¦ï¼Œæ‡‰è©²æä¾›å’©è£ç½®å›ºå®šå¯µç‰©ç± ï¼Ÿ',
                options: ['A. ç¹©ç´¢æˆ–é£›æ©Ÿå¸¶', 'B. ç”¨æ‰‹æ‰¶ä½', 'C. å””éœ€è¦æä¾›ï¼Œå®¢äººè‡ªç†'],
                answer: 'A'
            },
            {
                question: 'è¡Œè»ŠæœŸé–“ï¼Œæ‡‰è©²é»æ¨£ä¿éšœå¯µç‰©å®‰å…¨ï¼Ÿ',
                options: ['A. æ¸›æ…¢è»Šé€Ÿï¼Œæé†’ä¸»äººæª¢æŸ¥å¯µç‰©ç± å®‰å…¨æ‰£', 'B. é–‹å¿«å•²ï¼Œç›¡å¿«é€åˆ°ç›®çš„åœ°', 'C. å””éœ€è¦ç‰¹åˆ¥æ³¨æ„'],
                answer: 'A'
            },
            {
                question: 'å¯µç‰©è€³æœµéˆæ•ï¼Œæ‡‰è©²å–ºè»Šå»‚å…§ä¿æŒå’©èªéŸ³éŸ³é‡ï¼Ÿ',
                options: ['A. è¼•è²ç´°èª', 'B. æ­£å¸¸éŸ³é‡å³å¯', 'C. å¤§è²è¬›è©±'],
                answer: 'A'
            },
            {
                question: 'æ¥è¼‰å¯µç‰©è¨‚å–®æ™‚ï¼Œé»è§£è¦ç‰¹åˆ¥æ³¨æ„ç´°ç¯€ï¼Ÿ',
                options: ['A. å› ç‚ºæ¯å€‹å°ç´°ç¯€éƒ½ä¿‚å°å¯µç‰©åŒä¸»äººå˜…é—œæ‡·', 'B. å› ç‚ºç´°ç¯€å½±éŸ¿è©•åˆ†', 'C. å””éœ€è¦ç‰¹åˆ¥æ³¨æ„'],
                answer: 'A'
            },
            {
                question: 'é»æ¨£ç¢ºä¿ä¸‹ä¸€ä½ä¹˜å®¢å¯ä»¥äº«å—æ¸…æ½”å˜…è»Šå»‚ï¼Ÿ',
                options: ['A. æ¯æ¬¡å¯µç‰©è½è»Šå¾Œæ¸…æ½”åº§ä½', 'B. ç­‰ä¹˜å®¢è‡ªå·±è™•ç†', 'C. æ¯æ—¥ä¸€æ¬¡æ¸…æ½”å³å¯'],
                answer: 'A'
            },
            {
                question: 'ç‡å®Œå¯µç‰©è¨‚å–®æŒ‡å¼•å¾Œï¼Œæ‡‰è©²æœ‰å’©æ…‹åº¦å»å®Œæˆè¨‚å–®ï¼Ÿ',
                options: ['A. å¾—å¿ƒæ‡‰æ‰‹ï¼Œå°ˆæ¥­æœå‹™', 'B. éš¨ä¾¿å®Œæˆ', 'C. å””éœ€è¦ç†æœƒ'],
                answer: 'A'
            }
        ];

        startBtn.addEventListener('click', () => {
            driverId = driverIdInput.value.trim();
            phoneNumber = phoneNumberInput.value.trim();

            if (!driverId || !phoneNumber) {
                infoError.textContent = 'å¸æ©ŸIDåŒé›»è©±è™Ÿç¢¼éƒ½ä¿‚å¿…å¡«é …ç›®ï¼';
                infoError.classList.remove('hidden');
                return;
            }

            infoError.classList.add('hidden');
            infoPage.classList.add('hidden');
            quizPage.classList.remove('hidden');
            renderQuestion();
        });
        
        // æ¸²æŸ“é¡Œç›®
        function renderQuestion() {
            if (currentQuestionIndex >= quizData.length) {
                endQuiz();
                return;
            }

            const currentQuestion = quizData[currentQuestionIndex];
            questionNumberEl.textContent = `ç¬¬ ${currentQuestionIndex + 1} é¡Œ / å…± ${quizData.length} é¡Œ`;
            questionTextEl.textContent = currentQuestion.question;
            optionsContainer.innerHTML = '';
            feedbackMessageEl.textContent = '';
            
            // é‡ç½®å¯µç‰©è¡¨æƒ…
            dogEmojiEl.textContent = 'ğŸ¶';
            catEmojiEl.textContent = 'ğŸ±';
            
            currentQuestion.options.forEach((optionText) => {
                const optionButton = document.createElement('button');
                optionButton.textContent = optionText;
                optionButton.classList.add('question-option', 'w-full', 'bg-gray-200', 'text-gray-800', 'py-3', 'px-4', 'rounded-lg', 'font-medium', 'text-left', 'hover:bg-blue-200', 'transition', 'duration-200');
                optionButton.addEventListener('click', () => handleAnswer(optionText.charAt(0)));
                optionsContainer.appendChild(optionButton);
            });
        }

        // è™•ç†ç­”æ¡ˆ
        function handleAnswer(selectedAnswer) {
            const currentQuestion = quizData[currentQuestionIndex];
            if (selectedAnswer === currentQuestion.answer) {
                score++;
                // ç­”å°ï¼Œé¡¯ç¤ºå¿«æ¨‚è¡¨æƒ…ä¸¦å‰é€²
                updatePetStatus(true);
                setTimeout(() => {
                    currentQuestionIndex++;
                    renderQuestion();
                }, 1000); // å»¶é²1ç§’å¾Œé€²å…¥ä¸‹ä¸€é¡Œ
            } else {
                // ç­”éŒ¯ï¼Œé¡¯ç¤ºä¸å¿«æ¨‚è¡¨æƒ…ä¸¦ç¶­æŒåœ¨ç•¶å‰é¡Œç›®
                updatePetStatus(false);
            }
        }

        // æ›´æ–°å¯µç‰©è¡¨æƒ…
        function updatePetStatus(isCorrect) {
            if (isCorrect) {
                dogEmojiEl.textContent = 'ğŸ•'; // å¿«æ¨‚çš„ç‹—ç‹—
                catEmojiEl.textContent = 'ğŸ˜¸'; // å¿«æ¨‚çš„è²“å’ª
                feedbackMessageEl.textContent = 'ç­”å°äº†ï¼ä½ çœŸæ£’ï¼';
                feedbackMessageEl.classList.remove('text-red-500');
                feedbackMessageEl.classList.add('text-green-600');
            } else {
                dogEmojiEl.textContent = 'ğŸ•â€ğŸ¦º'; // ä¸å¿«æ¨‚çš„ç‹—ç‹—
                catEmojiEl.textContent = 'ğŸ˜¾'; // ä¸å¿«æ¨‚çš„è²“å’ª
                feedbackMessageEl.textContent = 'ç­”éŒ¯äº†ï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼';
                feedbackMessageEl.classList.remove('text-green-600');
                feedbackMessageEl.classList.add('text-red-500');
            }
        }

        async function endQuiz() {
            quizPage.classList.add('hidden');
            resultPage.classList.remove('hidden');

            const totalScore = score * (100 / quizData.length);
            let message = `ä½ ç­”å°äº† ${score} é¡Œï¼Œç¸½åˆ†ç‚º ${totalScore} åˆ†ã€‚`;
            if (totalScore === 100) {
                message += 'æ­å–œä½ ï¼ä½ ä¿‚æ¯›å­©ç•Œå˜…äº”æ˜Ÿç´šå¸æ©Ÿï¼ğŸ‰ ä½ å·²ç²å¾—20 GOåˆ†ï¼';
            } else {
                message += 'ç¹¼çºŒåŠªåŠ›ï¼Œä¸‹æ¬¡æœƒæ›´å¥½ï¼';
            }
            finalScoreTextEl.textContent = message;

            // æäº¤çµæœåˆ° Google Sheet
            loadingMessageEl.classList.remove('hidden');
            submitSuccessEl.classList.add('hidden');
            submitErrorEl.classList.add('hidden');

            try {
                // ä½¿ç”¨ GET è«‹æ±‚ä¸¦å°‡è³‡æ–™ä½œç‚º URL åƒæ•¸å‚³é€
                const params = new URLSearchParams({
                    driverId: driverId,
                    phoneNumber: phoneNumber,
                    score: totalScore
                });
                const fullUrl = `${GOOGLE_SHEET_APP_URL}?${params.toString()}`;

                const response = await fetch(fullUrl, {
                    method: 'GET'
                });

                // ç”±æ–¼ GET è«‹æ±‚åœ¨é€™ç¨®æƒ…æ³ä¸‹é€šå¸¸æœƒæˆåŠŸï¼Œæˆ‘å€‘å‡è¨­æäº¤æˆåŠŸ
                loadingMessageEl.classList.add('hidden');
                submitSuccessEl.classList.remove('hidden');
            } catch (error) {
                console.error('Error submitting data:', error);
                loadingMessageEl.classList.add('hidden');
                submitErrorEl.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>
